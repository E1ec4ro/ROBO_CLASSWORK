# PowerShell —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ ROS Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

Write-Host "=== ROS Docker Environment ===" -ForegroundColor Cyan
Write-Host ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Docker
if (-not (Get-Command docker -ErrorAction SilentlyContinue)) {
    Write-Host "–û—à–∏–±–∫–∞: Docker –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!" -ForegroundColor Red
    exit 1
}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Docker Compose
if (-not (Get-Command docker-compose -ErrorAction SilentlyContinue)) {
    Write-Host "–û—à–∏–±–∫–∞: Docker Compose –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!" -ForegroundColor Red
    exit 1
}

# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
Write-Host "–°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–±–æ—á–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π..." -ForegroundColor Yellow
New-Item -ItemType Directory -Force -Path "workspace" | Out-Null
New-Item -ItemType Directory -Force -Path "config" | Out-Null

# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
Write-Host ""
$rebuild = Read-Host "–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑? (y/n)"
if ($rebuild -eq "y" -or $rebuild -eq "Y") {
    Write-Host "–°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞..." -ForegroundColor Yellow
    docker-compose build
}

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
Write-Host ""
Write-Host "–ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞..." -ForegroundColor Yellow
docker-compose up -d

# –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞
Write-Host ""
Write-Host "–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤..." -ForegroundColor Yellow
Start-Sleep -Seconds 5

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
$container = docker ps --filter "name=ros_gazebo_rviz" --format "{{.Names}}"
if ($container -eq "ros_gazebo_rviz") {
    Write-Host ""
    Write-Host "‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω!" -ForegroundColor Green
    Write-Host ""
    Write-Host "üåê –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É:" -ForegroundColor Cyan
    Write-Host "   http://localhost:6080/vnc.html" -ForegroundColor White
    Write-Host ""
    Write-Host "üìù –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–µ—Ä–º–∏–Ω–∞–ª—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:" -ForegroundColor Cyan
    Write-Host "   docker exec -it ros_gazebo_rviz bash" -ForegroundColor White
    Write-Host ""
    Write-Host "üõë –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:" -ForegroundColor Cyan
    Write-Host "   docker-compose down" -ForegroundColor White
} else {
    Write-Host ""
    Write-Host "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞!" -ForegroundColor Red
    Write-Host "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: docker-compose logs" -ForegroundColor Yellow
}

